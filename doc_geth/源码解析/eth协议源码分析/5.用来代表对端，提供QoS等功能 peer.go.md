peer模块包含了downloader使用的peer节点，封装了吞吐量，是否空闲，并记录了之前失败的信息。

### peer
```go
// eth/downloader/peer.go
// peerConnection表示一个活动的对等节点，从该节点检索哈希值和区块。
type peerConnection struct {
	id string // 节点的唯一标识符

	rates   *msgrate.Tracker         // Tracker用于定位每秒可检索的项目数量。
	lacking map[common.Hash]struct{} // 不要请求的哈希集合（之前没有的）。

	peer Peer

	version uint       // 以太坊协议版本号用于切换策略。
	log     log.Logger // 上下文日志记录器用于向对等节点日志添加额外信息。
	lock    sync.RWMutex
}

// les/downloader/peer.go
// peerConnection represents an active peer from which hashes and blocks are retrieved.
type peerConnection struct {
    id string // Unique identifier of the peer
    
    headerIdle  int32 // Current header activity state of the peer (idle = 0, active = 1)
    blockIdle   int32 // Current block activity state of the peer (idle = 0, active = 1)
    receiptIdle int32 // Current receipt activity state of the peer (idle = 0, active = 1)
    stateIdle   int32 // Current node data activity state of the peer (idle = 0, active = 1)
    
    headerStarted  time.Time // Time instance when the last header fetch was started
    blockStarted   time.Time // Time instance when the last block (body) fetch was started
    receiptStarted time.Time // Time instance when the last receipt fetch was started
    stateStarted   time.Time // Time instance when the last node data fetch was started
    
    rates   *msgrate.Tracker         // Tracker to hone in on the number of items retrievable per second
    lacking map[common.Hash]struct{} // Set of hashes not to request (didn't have previously)
    
    peer Peer
    
    version uint       // Eth protocol version number to switch strategies
    log     log.Logger // Contextual logger to add extra infos to peer logs
    lock    sync.RWMutex
}
```

### FetchXXX
FetchHeaders、FetchBodies等函数 主要调用了eth.peer的功能来进行发送数据请求。
```go
// FetchHeaders sends a header retrieval request to the remote peer.
func (p *peerConnection) FetchHeaders(from uint64, count int) error {
	// Short circuit if the peer is already fetching
	if !atomic.CompareAndSwapInt32(&p.headerIdle, 0, 1) {
		return errAlreadyFetching
	}
	p.headerStarted = time.Now()

	// Issue the header retrieval request (absolute upwards without gaps)
	go p.peer.RequestHeadersByNumber(from, count, 0, false)

	return nil
}
```
> 本方法位于les/downloader/peer.go中，而不是eth/downloader/peer.go



















































